{"ast":null,"code":"var _jsxFileName = \"/home/anderson-mello/delivery-app-test/front-end/src/Pages/Products.js\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Header from '../Components/Header';\nimport ProductCard from '../Components/ProductCard';\nimport { AppContext } from '../Context/provider';\nimport { requestProducts } from '../Services/Request';\nimport { CartButton, ProductsSection } from './Styles/products';\n// import { requestToken, setToken } from '../Services/Request';\n// import { getUserInfo } from '../Services/Storage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst calculateTotalPrice = cart => {\n  let totalPrice = 0;\n  cart.forEach(item => {\n    totalPrice += item.subTotal;\n  });\n  return totalPrice;\n};\nexport default function Products() {\n  _s();\n  // useEffect(() => {\n  //   const checkToken = async () => {\n  //     const { token } = getUserInfo();\n  //     setToken(token);\n  //     await requestToken();\n  //   };\n  //   checkToken();\n  // }, []);\n\n  const [productsList, setProductsList] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const history = useHistory();\n  const {\n    cart\n  } = useContext(AppContext);\n  useEffect(() => {\n    const fetchProducts = async () => {\n      const products = await requestProducts('/products');\n      setProductsList(products);\n    };\n    fetchProducts();\n  }, []);\n  useEffect(() => {\n    setTotalPrice(calculateTotalPrice(cart));\n  }, [cart]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ProductsSection, {\n      className: \"product-list\",\n      children: productsList.map(product => /*#__PURE__*/_jsxDEV(ProductCard, {\n        product: product\n      }, product.name, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CartButton, {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        disabled: totalPrice === 0,\n        onClick: () => {\n          history.push('/customer/checkout');\n        },\n        \"data-testid\": \"customer_products__button-cart\",\n        children: [\"Ver Carrinho: R$\", /*#__PURE__*/_jsxDEV(\"p\", {\n          \"data-testid\": \"customer_products__checkout-bottom-value\",\n          children: Number(totalPrice).toLocaleString('pt-br', {\n            minimumFractionDigits: 2\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Products, \"4SFL6Q/9UUhe1CVt+oit7OOmkbM=\", false, function () {\n  return [useHistory];\n});\n_c = Products;\nvar _c;\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"names":["useContext","useEffect","useState","useHistory","Header","ProductCard","AppContext","requestProducts","CartButton","ProductsSection","calculateTotalPrice","cart","totalPrice","forEach","item","subTotal","Products","productsList","setProductsList","setTotalPrice","history","fetchProducts","products","map","product","name","push","Number","toLocaleString","minimumFractionDigits"],"sources":["/home/anderson-mello/delivery-app-test/front-end/src/Pages/Products.js"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport Header from '../Components/Header';\nimport ProductCard from '../Components/ProductCard';\nimport { AppContext } from '../Context/provider';\nimport { requestProducts } from '../Services/Request';\nimport { CartButton, ProductsSection } from './Styles/products';\n// import { requestToken, setToken } from '../Services/Request';\n// import { getUserInfo } from '../Services/Storage';\n\nconst calculateTotalPrice = (cart) => {\n  let totalPrice = 0;\n  cart.forEach((item) => { totalPrice += item.subTotal; });\n  return totalPrice;\n};\n\nexport default function Products() {\n  // useEffect(() => {\n  //   const checkToken = async () => {\n  //     const { token } = getUserInfo();\n  //     setToken(token);\n  //     await requestToken();\n  //   };\n  //   checkToken();\n  // }, []);\n\n  const [productsList, setProductsList] = useState([]);\n  const [totalPrice, setTotalPrice] = useState(0);\n  const history = useHistory();\n\n  const { cart } = useContext(AppContext);\n\n  useEffect(() => {\n    const fetchProducts = async () => {\n      const products = await requestProducts('/products');\n      setProductsList(products);\n    };\n\n    fetchProducts();\n  }, []);\n\n  useEffect(() => {\n    setTotalPrice(calculateTotalPrice(cart));\n  }, [cart]);\n\n  return (\n    <>\n      <Header />\n      <ProductsSection className=\"product-list\">\n        {productsList.map((product) => (\n          <ProductCard product={ product } key={ product.name } />\n        ))}\n      </ProductsSection>\n      <CartButton>\n        <button\n          type=\"button\"\n          disabled={ totalPrice === 0 }\n          onClick={ () => { history.push('/customer/checkout'); } }\n          data-testid=\"customer_products__button-cart\"\n        >\n          Ver Carrinho: R$\n          <p data-testid=\"customer_products__checkout-bottom-value\">\n            {Number(totalPrice).toLocaleString('pt-br', { minimumFractionDigits: 2 })}\n          </p>\n        </button>\n      </CartButton>\n    </>\n  );\n}\n"],"mappings":";;AAAA,SAASA,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACvD,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,OAAOC,MAAM,MAAM,sBAAsB;AACzC,OAAOC,WAAW,MAAM,2BAA2B;AACnD,SAASC,UAAU,QAAQ,qBAAqB;AAChD,SAASC,eAAe,QAAQ,qBAAqB;AACrD,SAASC,UAAU,EAAEC,eAAe,QAAQ,mBAAmB;AAC/D;AACA;AAAA;AAAA;AAEA,MAAMC,mBAAmB,GAAIC,IAAI,IAAK;EACpC,IAAIC,UAAU,GAAG,CAAC;EAClBD,IAAI,CAACE,OAAO,CAAEC,IAAI,IAAK;IAAEF,UAAU,IAAIE,IAAI,CAACC,QAAQ;EAAE,CAAC,CAAC;EACxD,OAAOH,UAAU;AACnB,CAAC;AAED,eAAe,SAASI,QAAQ,GAAG;EAAA;EACjC;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACU,UAAU,EAAEO,aAAa,CAAC,GAAGjB,QAAQ,CAAC,CAAC,CAAC;EAC/C,MAAMkB,OAAO,GAAGjB,UAAU,EAAE;EAE5B,MAAM;IAAEQ;EAAK,CAAC,GAAGX,UAAU,CAACM,UAAU,CAAC;EAEvCL,SAAS,CAAC,MAAM;IACd,MAAMoB,aAAa,GAAG,YAAY;MAChC,MAAMC,QAAQ,GAAG,MAAMf,eAAe,CAAC,WAAW,CAAC;MACnDW,eAAe,CAACI,QAAQ,CAAC;IAC3B,CAAC;IAEDD,aAAa,EAAE;EACjB,CAAC,EAAE,EAAE,CAAC;EAENpB,SAAS,CAAC,MAAM;IACdkB,aAAa,CAACT,mBAAmB,CAACC,IAAI,CAAC,CAAC;EAC1C,CAAC,EAAE,CAACA,IAAI,CAAC,CAAC;EAEV,oBACE;IAAA,wBACE,QAAC,MAAM;MAAA;MAAA;MAAA;IAAA,QAAG,eACV,QAAC,eAAe;MAAC,SAAS,EAAC,cAAc;MAAA,UACtCM,YAAY,CAACM,GAAG,CAAEC,OAAO,iBACxB,QAAC,WAAW;QAAC,OAAO,EAAGA;MAAS,GAAOA,OAAO,CAACC,IAAI;QAAA;QAAA;QAAA;MAAA,QACpD;IAAC;MAAA;MAAA;MAAA;IAAA,QACc,eAClB,QAAC,UAAU;MAAA,uBACT;QACE,IAAI,EAAC,QAAQ;QACb,QAAQ,EAAGb,UAAU,KAAK,CAAG;QAC7B,OAAO,EAAG,MAAM;UAAEQ,OAAO,CAACM,IAAI,CAAC,oBAAoB,CAAC;QAAE,CAAG;QACzD,eAAY,gCAAgC;QAAA,WAC7C,kBAEC;UAAG,eAAY,0CAA0C;UAAA,UACtDC,MAAM,CAACf,UAAU,CAAC,CAACgB,cAAc,CAAC,OAAO,EAAE;YAAEC,qBAAqB,EAAE;UAAE,CAAC;QAAC;UAAA;UAAA;UAAA;QAAA,QACvE;MAAA;QAAA;QAAA;QAAA;MAAA;IACG;MAAA;MAAA;MAAA;IAAA,QACE;EAAA,gBACZ;AAEP;AAAC,GApDuBb,QAAQ;EAAA,QAYdb,UAAU;AAAA;AAAA,KAZJa,QAAQ;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}